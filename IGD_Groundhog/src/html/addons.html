<!DOCTYPE html>
<html>
	<head>
		<title>Add-ons manager</title>
		<meta charset="UTF-8">
	</head>
	<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans" />
	<link rel="stylesheet" type="text/css" href="css/general.css">
	<body>
        <div style="width: 445px">
        <h1>Add-on manager</h1>
        <table style="margin-left:10px">
            <tr>
                <td>
                    <select multiple onchange="show_info(this)" id="inactive_addons" size="10" style="display:inline;margin:auto;width: 200px;"></select>

                </td>

                <td >
                    <a href="#" style="display:block" onclick='activate_addons()'> >> </a>
                    <a href="#" style="display:block" onclick='deactivate_addons()'> << </a>
                </td>

                <td>
                    <select multiple onchange="show_info(this)" id="active_addons" size="10" style="display:inline;margin:auto;width: 200px;"></select>
                </td>
            </tr>
            <tr>
                <td style="text-align:center">Inactive Add-ons</td><td></td><td style="text-align:center">Active Add-ons</td>
            </tr>
        </table>
        <p align="center"> <button onclick='save_addon_conf()'> Save configuration </button></p>
        <fieldset style="margin:10px">
            <legend>Info</legend>
            <table>
                <tr>
                    <td valign="top"><b>NAME:</b></td><td><p align='justify' style="margin:0; font-size: 95%;" id='name'></p></td>
                </tr>
                <tr>
                    <td valign="top"><b>DEVELOPER:</b></td><td><p align='justify' style="margin:0; font-size: 95%;" id='developer'></p></td>
                </tr>
                <tr>
                    <td valign="top"><b>VERSION:</b></td><td><p align='justify' style="margin:0; font-size: 95%;" id='version'></p></td>
                </tr>
                <tr>
                    <td valign="top"><b>SUPPORT:</b></td><td><p align='justify' style="margin:0; font-size: 95%;" id='support'></p></td>
                </tr>
                <tr>
                    <td valign="top"><b>INFO:</b></td><td><textarea readonly align='justify' rows="6" cols="40" style="margin:0; font-size: 95%;" id='info'></textarea></td>
                </tr>
            </table>

        </fieldset>


        <p align="left"> <button onclick='install_addon()'>Install new addon</button></p>
    </div>
	</body>

     <script>

        function show_info(e){
            document.getElementById('name').innerHTML=e.options[e.selectedIndex].getAttribute('name');
            document.getElementById('developer').innerHTML=e.options[e.selectedIndex].getAttribute('developer');
            document.getElementById('version').innerHTML=e.options[e.selectedIndex].getAttribute('version');
            document.getElementById('support').innerHTML=e.options[e.selectedIndex].getAttribute('support');
            document.getElementById('info').innerHTML=e.options[e.selectedIndex].getAttribute('info');
        }

        function install_addon(){
            window.location.href = 'skp:install_addon@message';
        }

        function activate_addons(){
            var inactive=document.getElementById('inactive_addons');
            var active=document.getElementById('active_addons');
            var options = inactive && inactive.options;

            for (var i=0; i<options.length; i++) {
                if (options[i].selected) {
                    active.appendChild(options[i]);
                    i--;
                }
            }
        }

        function deactivate_addons(){
            var inactive=document.getElementById('inactive_addons');
            var active=document.getElementById('active_addons');
            var options = active && active.options;

            for (var i=0; i<options.length; i++) {
                if (options[i].selected) {
                    inactive.appendChild(options[i]);
                    i--;
                }
            }
        }

        function save_addon_conf(){
            var active=document.getElementById('active_addons');
            var options = active && active.options;

            str=[]
            for (var i=0; i<options.length; i++) {
                    str.push(options[i].value)
            }

            var query = 'skp:save_addon_conf@'+str.join(",");
            window.location.href = query;
        }

        window.location.href = 'skp:onLoad@message';


     </script>


</html>
